function icl_st_toggler(){jQuery(".icl-st-inline").slideUp();var a=jQuery(this).parent().next().next();"none"==a.css("display")?a.slideDown():a.slideUp(),icl_st_show_html_preview_close()}function icl_st_monitor_ta(){if(void 0!==jQuery(this).attr("id")){var a=jQuery(this).attr("id").replace(/^icl_st_ta_/,"");void 0==icl_st_ta_cache[a]&&(icl_st_ta_cache[a]=jQuery(this).val(),icl_st_cb_cache[a]=jQuery("#icl_st_cb_"+a).attr("checked"))}}function icl_st_monitor_ta_check_modifications(){if(void 0!==jQuery(this).attr("id")){var a=jQuery(this).attr("id").replace(/^icl_st_ta_/,"");icl_st_ta_cache[a]!=jQuery(this).val()?jQuery("#icl_st_cb_"+a).removeAttr("checked"):icl_st_cb_cache[a]&&jQuery("#icl_st_cb_"+a).attr("checked","checked")}icl_st_show_html_preview_close()}function icl_st_submit_translation(){var a=jQuery(this),b=a.serialize();b+="&icl_ajx_action=icl_st_save_translation",a.contents().find("textarea, input").attr("disabled","disabled"),a.contents().find(".icl_ajx_loader").fadeIn();var c=a.find('input[name="icl_st_string_id"]').val();return jQuery.post(icl_ajx_url,b,function(b){a.contents().find("textarea, input").removeAttr("disabled"),a.contents().find(".icl_ajx_loader").fadeOut();var d=b.split("|");jQuery("#icl_st_string_status_"+c).html(d[1])}),!1}function icl_st_filter_status(){var a=""!=jQuery(this).val()?"&status="+jQuery(this).val():"";location.href=location.href.replace(/#(.*)$/,"").replace(/&paged=([0-9]+)/,"").replace(/&updated=true/,"").replace(/&status=([0-9a-z-]+)/g,"")+a}function icl_st_filter_context(){var a=""!=jQuery(this).val()?"&context="+encodeURIComponent(jQuery(this).val()):"";location.href=location.href.replace(/#(.*)$/,"").replace(/&paged=([0-9]+)/,"").replace(/&updated=true/,"").replace(/&context=(.*)/g,"")+a}function icl_st_filter_translation_priority(){var a=""!=jQuery(this).val()?"&translation-priority="+encodeURIComponent(jQuery(this).val()):"";location.href=location.href.replace(/#(.*)$/,"").replace(/&paged=([0-9]+)/,"").replace(/&updated=true/,"").replace(/&translation-priority=(.*)/g,"")+a}function icl_st_filter_search(){var a=jQuery('select[name="icl_st_filter_context"]').val(),b=jQuery("#icl_st_filter_search").val(),c=jQuery("#icl_st_filter_search_em").attr("checked"),d=""!=b?"&search="+encodeURIComponent(b):"",e=location.href;d=d.replace(/&em=1/g,""),c&&(d+="&em=1"),e=e.replace(/#(.*)$/,"").replace(/&paged=([0-9]+)/,"").replace(/&updated=true/,"").replace(/&search=(.*)/g,"")+d,""==a&&(e=e.replace(/&context=(.*)/g,"")),location.href=e}function icl_st_filter_search_remove(){location.href=location.href.replace(/#(.*)$/,"").replace(/&search=(.*)/g,"").replace(/&em=1/g,"")}function icl_st_delete_selected(){var a,b,c,d=jQuery(".icl_st_row_cb:checked");return d.length&&(c=jQuery(this).data("confirm"),confirm(c)&&(b=[],d.each(function(){var a=jQuery(this).val();b.push(a),jQuery(this).trigger("click")}),b&&(a="icl_ajx_action=icl_st_delete_strings&value="+b.join(",")+"&_icl_nonce="+jQuery("#_icl_nonce_dstr").val(),jQuery.post(icl_ajx_url,a,function(){for(var a=0;a<b.length;a++)jQuery('.icl_st_row_cb[value="'+b[a]+'"]').parent().parent().fadeOut("fast",function(){jQuery(this).remove()})})))),!1}function icl_st_send_strings(){var a=jQuery(".icl_st_row_cb:checked");if(!a.length)return!1;var b=[];return a.each(function(){b.push(jQuery(this).val())}),!!b.length&&(jQuery("#icl_st_send_strings").find('input[name="strings"]').val(b.join(",")),!0)}function icl_st_update_languages(){jQuery("#icl_tm_languages").find("input:checked").length?jQuery(".icl_st_row_cb:checked, .check-column input:checked").length&&0===jQuery(".js-lang-not-active:checked").length&&jQuery("#icl_send_strings").removeAttr("disabled"):jQuery("#icl_send_strings").attr("disabled","disabled");var a=jQuery(this),b=a.attr("name").replace(/translate_to\[(.+)]/,"$1");1==a.attr("checked")&&"icanlocalize"===jQuery("#icl_st_service_"+b).val()?icl_st_show_estimated_cost(b):icl_st_hide_estimated_cost(b)}function show_package_incomplete_notice(a){var b=jQuery("#wpml-st-package-incomplete");a?b.hide():b.show()}function get_checked_cbs(){var a={},b=jQuery('select[name="icl_st_filter_context"]').find("option")||[];jQuery.each(b,function(b,c){c=jQuery(c),a[c.val()]=c.data("unfiltered-count")});var c=jQuery("#icl_string_translations"),d=c.find(".icl_st_row_package:checked")||[],e={};jQuery.each(d,function(b,c){var d=jQuery(jQuery(c).closest("tr")).find(".wpml-st-col-domain").text();e[d]=e.hasOwnProperty(d)?e[d]:a[d],e[d]=e[d]-1,jQuery(c).data("package-domain",d)});var f=c.find(".icl_st_row_cb:checked");f=f.length>0?f:[];var g,h=!1;for(g in e)e.hasOwnProperty(g)&&e[g]>0&&(h=!0);return show_package_incomplete_notice(!h||0===f.length),h?[]:f}function icl_st_update_checked_elements(){if(jQuery(this).closest("th").hasClass("manage-column")&&jQuery(".icl_st_row_cb").prop("checked",jQuery(this).prop("checked")),jQuery("#icl_st_change_lang_selected").prop("disabled",0===get_checked_cbs().length),jQuery("#icl-st-change-translation-priority-selected").prop("disabled",0===get_checked_cbs().length),jQuery(".js-change-translation-priority .select2-choice, .js-simple-lang-selector-flags .select2-choice").attr("disabled",0===get_checked_cbs().length),jQuery(".icl_st_row_cb:checked").length){jQuery("#icl_st_delete_selected").prop("disabled",!1);var a=jQuery("#icl-tr-opt");a.length&&!a.find("input:checked").length||WPML_String_Translation.translation_basket.maybe_enable_button()&&WPML_String_Translation.translation_basket.show_target_languages()}else jQuery("#icl_st_delete_selected, #icl_send_strings").prop("disabled",!0),WPML_String_Translation.translation_basket.clear_message();jQuery(".icl_st_estimate_wrap:visible").each(function(){icl_st_show_estimated_cost(jQuery(this).attr("id").replace(/icl_st_estimate_(.+)_wrap/,"$1"))}),jQuery(this).hasClass("icl_st_row_cb")&&set_bulk_selects(0===jQuery(".icl_st_row_cb:not(:checked)").length)}function set_bulk_selects(a){jQuery(".check-column input").attr("checked",!!a&&"checked")}function icl_st_show_html_preview(){var a=jQuery(this).parent(),b=a.parent().prev().find('textarea[name="icl_st_translation"]');return"none"==a.find(".icl_html_preview").css("display")?a.find(".icl_html_preview").html(b.val().replace(/(\n|\r)/g,"<br>")).slideDown():a.find(".icl_html_preview").slideUp(),!1}function icl_st_show_html_preview_close(){jQuery(".icl_html_preview").slideUp()}function icl_validate_po_upload(){var a=jQuery(this).contents();return a.find(".icl_error_text").hide(),jQuery("#icl_po_file").val()?a.find('select[name="icl_st_i_context"]').val()||a.find('input[name="icl_st_i_context_new"]').val()?void 0:(a.find("#icl_st_err_domain").fadeIn(),!1):(a.find("#icl_st_err_po").fadeIn(),!1)}function icl_show_in_source(a,b){return icl_show_in_source_scroll_once?b>40&&(b-=10,location.href=location.protocol+"//"+location.host+location.pathname+location.search+"#icl_source_line_"+a+"_"+b):jQuery(".icl_string_track_source").fadeOut(function(){jQuery("#icl_string_track_source_"+a).fadeIn(function(){b>40&&(b-=10,location.href=location.protocol+"//"+location.host+location.pathname+location.search+"#icl_source_line_"+a+"_"+b)})}),!1}function iclResizeIframe(){var a=jQuery("#icl_string_track_frame_wrap").find("iframe"),b=jQuery("#TB_ajaxContent");a.attr("height",b.height()-20),a.attr("width",b.width())}function icl_st_admin_options_form_submit(){jQuery("input:checkbox.icl_st_has_translations:not(:checked)").length&&(iclHaltSave=!confirm(jQuery("#icl_st_options_write_confirm").html())),iclSaveForm_success_cb.push(function(){jQuery("#icl_st_options_write_success").fadeIn()})}function icl_st_admin_strings_toggle_strings(){var a=jQuery(this);return jQuery(this).parent().next().slideToggle(function(){"+"==a.html().charAt(0)?a.html(a.html().replace(/^\+/,"-")):a.html(a.html().replace(/^-/,"+"))}),!1}function icl_st_ow_export_selected(){jQuery("#icl_st_ow_export").attr("disabled","disabled"),jQuery("#icl_st_option_writes").find(".ajax_loader").fadeIn(),jQuery.ajax({type:"POST",dataType:"json",url:icl_ajx_url,data:"icl_ajx_action=icl_st_ow_export&"+jQuery("#icl_st_option_write_form").serialize()+"&_icl_nonce="+jQuery("#_icl_nonce_owe").val(),success:function(a){jQuery("#icl_st_ow_export_out").html(a.message).slideDown(),jQuery("#icl_st_option_writes").find(".ajax_loader").fadeOut(function(){jQuery("#icl_st_ow_export_close").fadeIn()})}})}function icl_st_ow_export_close(){jQuery("#icl_st_ow_export_out").slideUp(function(){jQuery("#icl_st_ow_export_close").fadeOut()}),jQuery("#icl_st_ow_export").removeAttr("disabled")}function icl_st_pop_download(){return location.href=ajaxurl+"?action=icl_st_pop_download&file="+jQuery(this).attr("href").substr(1),!1}function icl_st_selected_word_count(){var a=0;return jQuery(".icl_st_row_cb:checked").each(function(){var b=jQuery(this).val();a+=parseInt(jQuery("#icl_st_wc_"+b).val())}),a}function icl_st_show_estimated_cost(a){var b=icl_st_selected_word_count()*jQuery("#icl_st_max_rate_"+a).html();jQuery("#icl_st_estimate_"+a).html(Math.round(100*b)/100),jQuery("#icl_st_estimate_"+a+"_wrap").show()}function icl_st_hide_estimated_cost(a){jQuery("#icl_st_estimate_"+a+"_wrap").hide()}function icl_st_change_service(){var a=jQuery(this).attr("name").replace(/service\[(.+)]/,"$1");"icanlocalize"==jQuery(this).val()?jQuery("#icl_st_translate_to_"+a).attr("checked")&&icl_st_show_estimated_cost(a):icl_st_hide_estimated_cost(a)}jQuery(document).ready(function(){jQuery(".wpml-colorpicker").wpColorPicker(),jQuery('a[href="#icl-st-toggle-translations"]').click(icl_st_toggler);var a=jQuery(".icl-st-inline textarea");a.focus(icl_st_monitor_ta),a.keyup(icl_st_monitor_ta_check_modifications),jQuery(".icl_st_form").submit(icl_st_submit_translation),jQuery('select[name="icl_st_filter_status"]').change(icl_st_filter_status),jQuery('select[name="icl_st_filter_context"]').change(icl_st_filter_context),jQuery('select[name="icl-st-filter-translation-priority"]').change(icl_st_filter_translation_priority),jQuery("#icl_st_filter_search_sb").click(icl_st_filter_search),jQuery("#icl_st_filter_search").keyup(function(a){13===a.keyCode&&icl_st_filter_search()}),jQuery("#icl_st_filter_search_remove").click(icl_st_filter_search_remove),jQuery("#icl_st_delete_selected").click(icl_st_delete_selected),jQuery("#icl_st_po_translations").click(function(){jQuery(this).attr("checked")?jQuery("#icl_st_po_language").removeAttr("disabled").fadeIn():jQuery("#icl_st_po_language").attr("disabled","disabled").fadeOut()});var b=jQuery("#icl_tm_languages");b.find(":checkbox").click(icl_st_update_languages),jQuery(".icl_st_row_cb, .check-column :checkbox").click(icl_st_update_checked_elements),b.find("select").change(icl_st_change_service),jQuery(".icl_htmlpreview_link").click(icl_st_show_html_preview),jQuery("#icl_st_po_form").submit(icl_validate_po_upload),jQuery("#icl_st_send_strings").submit(icl_st_send_strings),jQuery(".handlediv").click(function(){jQuery(this).parent().toggleClass("closed")}),jQuery("#icl_st_track_strings").submit(iclSaveForm);var c=jQuery("#icl_st_option_write_form");c.submit(icl_st_admin_options_form_submit),c.submit(iclSaveForm),jQuery(".icl_stow_toggler").click(icl_st_admin_strings_toggle_strings),jQuery("#icl_st_ow_export").click(icl_st_ow_export_selected),jQuery("#icl_st_ow_export_close").click(icl_st_ow_export_close),jQuery(".pick-show").click(function(){var a=jQuery(this).offset();jQuery("#colorPickerDiv").css({top:a.top-180,left:a.left,"z-index":99})}),jQuery('input[name="wpml_st_theme_localization_type_wpml_td"]').on("click",function(){var a=jQuery(this).prop("checked");jQuery('input[name="wpml_st_theme_localization_type_wpml_td"]').prop("checked",a)}),jQuery(document).delegate(".wpml_st_pop_download","click",icl_st_pop_download);var d=jQuery("#icl_st_more_options");d.submit(iclSaveForm),d.submit(function(){var a=jQuery("#icl_st_tusers");a.find("label input:checked").length?jQuery("#icl_st_tusers_list").html(a.find("label input:checked").next().map(function(){return jQuery(this).html()}).get().join(", ")):jQuery("#icl_st_tusers_list").html("-")})});var icl_st_ta_cache=[],icl_st_cb_cache=[],icl_show_in_source_scroll_once=!1;jQuery(document).delegate("#icl_show_source_wrap","mouseover",function(){icl_show_in_source_scroll_once&&(icl_show_in_source(0,icl_show_in_source_scroll_once),icl_show_in_source_scroll_once=!1)});